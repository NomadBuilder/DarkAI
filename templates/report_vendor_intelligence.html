<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-MZ69VXXL');</script>
  <!-- End Google Tag Manager -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>2025 Synthetic Identity Vendor Intelligence Report â€“ Dark AI</title>
  <meta name="description" content="Comprehensive analysis of the synthetic identity vendor ecosystem - 129+ vendors tracked across platforms, services, and infrastructure." />
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://darkai.ca/reports/vendor-intelligence-report" />
  <meta property="og:title" content="2025 Synthetic Identity Vendor Intelligence Report â€“ Dark AI" />
  <meta property="og:description" content="Comprehensive analysis of the synthetic identity vendor ecosystem." />
  <meta property="og:image" content="https://i.imgur.com/YTCnPOE.png" />
  
  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:url" content="https://darkai.ca/reports/vendor-intelligence-report" />
  <meta name="twitter:title" content="2025 Synthetic Identity Vendor Intelligence Report â€“ Dark AI" />
  <meta name="twitter:description" content="Comprehensive analysis of the synthetic identity vendor ecosystem." />
  <meta name="twitter:image" content="https://i.imgur.com/YTCnPOE.png" />
  
  <!-- Canonical URL -->
  <link rel="canonical" href="https://darkai.ca/reports/vendor-intelligence-report" />
  
  <!-- Structured Data (JSON-LD) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Report",
    "name": "2025 Synthetic Identity Vendor Intelligence Report",
    "description": "Comprehensive analysis of the synthetic identity vendor ecosystem based on intelligence gathered from 129+ vendors across multiple platforms",
    "url": "https://darkai.ca/reports/vendor-intelligence-report",
    "datePublished": "2025-12-05",
    "dateModified": "2025-12-05",
    "publisher": {
      "@type": "Organization",
      "name": "Dark AI",
      "url": "https://darkai.ca",
      "logo": {
        "@type": "ImageObject",
        "url": "https://i.imgur.com/YTCnPOE.png"
      }
    },
    "author": {
      "@type": "Organization",
      "name": "Dark AI"
    },
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https://darkai.ca/reports/vendor-intelligence-report"
    },
    "about": {
      "@type": "Thing",
      "name": "Synthetic Identity Vendors",
      "description": "Analysis of vendors selling synthetic identities, fake documents, and related services"
    },
    "keywords": "synthetic identity, fake documents, identity fraud, vendor intelligence, cybersecurity, threat intelligence"
  }
  </script>
  
  <link rel="icon" type="image/svg+xml" href="/static/favicon.svg" />
  <link rel="alternate icon" href="/static/favicon.svg" />
  
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>

  <style>
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    @keyframes countUp {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    html {
      scroll-behavior: smooth;
      scroll-padding-top: 100px;
    }
    
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Inter", "Helvetica Neue", Arial, sans-serif;
      background: #0a0b14;
      color: #f2f3f5;
      position: relative;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      line-height: 1.6;
    }
    
    /* Professional gradient background */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: 
        radial-gradient(circle at 20% 50%, rgba(255, 107, 107, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(100, 181, 246, 0.08) 0%, transparent 50%),
        linear-gradient(180deg, #0a0b14 0%, #0f1119 100%);
      z-index: -1;
    }
    
    /* Navigation */
    nav {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: rgba(10, 11, 20, 0.95);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.08);
      padding: 1.25rem 2rem;
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    
    nav .logo {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      font-size: 1.4rem;
      font-weight: 700;
      letter-spacing: 0.02em;
    }
    
    nav .logo-mark {
      width: 26px;
      height: 26px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 20%, #f97373, #dc2626 48%, #111827 100%);
      box-shadow: 0 0 22px rgba(248,113,113,0.8), 0 0 60px rgba(127,29,29,0.8);
      position: relative;
      flex-shrink: 0;
      cursor: pointer;
      transition: transform 0.2s ease;
    }
    nav .logo-mark:hover {
      transform: scale(1.1);
    }
    
    .hamburger {
      display: none;
      flex-direction: column;
      background: transparent;
      border: none;
      cursor: pointer;
      padding: 0.5rem;
      gap: 0.3rem;
    }
    
    .hamburger span {
      width: 25px;
      height: 2px;
      background: #e0e0e0;
      transition: all 0.3s ease;
    }
    
    .hamburger.active span:nth-child(1) {
      transform: rotate(45deg) translate(8px, 8px);
    }
    
    .hamburger.active span:nth-child(2) {
      opacity: 0;
    }
    
    .hamburger.active span:nth-child(3) {
      transform: rotate(-45deg) translate(7px, -7px);
    }
    
    .nav-links {
      display: flex;
      align-items: center;
      gap: 0;
    }
    
    .nav-dropdown {
      position: relative;
    }
    
    .nav-dropdown-toggle {
      text-decoration: none;
      margin-left: 1.8rem;
      color: #e0e0e0;
      font-size: 0.95rem;
      white-space: nowrap;
      transition: color 0.3s;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 0.3rem;
    }
    
    .nav-dropdown-toggle:hover {
      color: #ff6b6b;
    }
    
    .nav-dropdown-toggle::after {
      content: 'â–¼';
      font-size: 0.7rem;
      transition: transform 0.3s;
    }
    
    .nav-dropdown.active .nav-dropdown-toggle::after {
      transform: rotate(180deg);
    }
    
    .nav-dropdown-menu {
      position: absolute;
      top: 100%;
      left: 0;
      margin-top: 0.5rem;
      background: rgba(10, 11, 20, 0.98);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      padding: 0.5rem 0;
      min-width: 200px;
      opacity: 0;
      visibility: hidden;
      transform: translateY(-10px);
      transition: all 0.3s ease;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
    }
    
    .nav-dropdown.active .nav-dropdown-menu {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }
    
    .nav-dropdown-menu a {
      display: block;
      padding: 0.9rem 1.75rem;
      color: #e0e0e0;
      text-decoration: none;
      font-size: 0.95rem;
      transition: background 0.2s, color 0.2s;
      margin: 0;
    }
    
    .nav-dropdown-menu a:hover {
      background: rgba(255, 107, 107, 0.1);
      color: #ff6b6b;
    }
    
    nav a {
      text-decoration: none;
      margin-left: 1.8rem;
      color: #e0e0e0;
      font-size: 0.95rem;
      white-space: nowrap;
      transition: color 0.3s;
    }
    nav a:hover {
      color: #ff6b6b;
    }
    nav .logo a {
      margin-left: 0;
    }
    
    @media (max-width: 768px) {
      .hamburger {
        display: flex;
      }
      
      .nav-links {
        position: fixed;
        top: 0;
        right: -100%;
        width: 320px;
        height: 100vh;
        height: 100dvh; /* Use dynamic viewport height for mobile */
        height: calc(var(--vh, 1vh) * 100); /* Fallback using CSS variable */
        max-height: 100vh;
        background: rgba(10, 11, 20, 0.98);
        backdrop-filter: blur(20px);
        flex-direction: column;
        align-items: flex-start;
        padding: 5rem 2.5rem 2rem;
        gap: 0.5rem;
        transition: right 0.3s ease;
        box-shadow: -4px 0 20px rgba(0, 0, 0, 0.5);
        z-index: 1000;
        overflow-y: auto;
      }
      
      .nav-links.active {
        right: 0;
      }
      
      .nav-links a,
      .nav-dropdown {
        display: block;
        width: 100%;
        margin-left: 0;
      }
      
      .nav-dropdown-toggle {
        width: 100%;
        padding: 1rem 0;
        font-size: 1.1rem;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }
      
      .nav-dropdown-menu {
        position: static;
        opacity: 1;
        visibility: visible;
        transform: none;
        background: transparent;
        border: none;
        box-shadow: none;
        margin-top: 0;
        margin-left: 0;
        display: none;
      }
      
      .nav-dropdown.active .nav-dropdown-menu {
        display: block;
      }
      
      .nav-dropdown-menu a {
        padding: 0.9rem 0;
        margin: 0;
      }
      
      .nav-links a {
        padding: 0.9rem 0;
        font-size: 1rem;
      }
    }

    /* Professional Hero Section */
    header.hero {
      padding: 6rem 2rem 4rem;
      text-align: center;
      max-width: 1000px;
      margin: 0 auto;
      position: relative;
      animation: fadeInUp 1s ease-out;
    }
    
    header.hero h1 {
      font-size: clamp(2.5rem, 5vw, 4rem);
      font-weight: 800;
      line-height: 1.1;
      margin-bottom: 1.5rem;
      background: linear-gradient(135deg, #ff6b6b 0%, #ff4444 50%, #64b5f6 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      letter-spacing: -0.02em;
    }
    
    header.hero .subtitle {
      font-size: 1.3rem;
      color: #b4bac3;
      margin-bottom: 2rem;
      line-height: 1.6;
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
    }
    
    header.hero .meta {
      display: flex;
      justify-content: center;
      gap: 2rem;
      flex-wrap: wrap;
      color: #9aa0a6;
      font-size: 0.95rem;
      margin-top: 2rem;
    }
    
    .export-buttons {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-top: 2.5rem;
      flex-wrap: wrap;
    }
    
    .export-btn {
      padding: 0.75rem 1.5rem;
      background: rgba(255, 107, 107, 0.15);
      border: 1px solid rgba(255, 107, 107, 0.3);
      border-radius: 8px;
      color: #fee2e2;
      cursor: pointer;
      font-size: 0.95rem;
      font-weight: 500;
      transition: all 0.2s ease;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      font-family: inherit;
    }
    
    .export-btn:hover {
      background: rgba(255, 107, 107, 0.25);
      border-color: rgba(255, 107, 107, 0.5);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(255, 107, 107, 0.2);
    }
    
    .export-btn:active {
      transform: translateY(0);
    }

    /* Professional Stat Cards */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 2rem;
      max-width: 1200px;
      margin: 4rem auto;
      padding: 0 2rem;
    }
    
    .stat-card {
      background: linear-gradient(135deg, rgba(11, 13, 22, 0.95) 0%, rgba(20, 22, 35, 0.95) 100%);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: 16px;
      padding: 2.5rem;
      text-align: center;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
      opacity: 0;
      animation: fadeInUp 0.8s ease-out forwards;
    }
    
    .stat-card:nth-child(1) { animation-delay: 0.1s; }
    .stat-card:nth-child(2) { animation-delay: 0.2s; }
    .stat-card:nth-child(3) { animation-delay: 0.3s; }
    .stat-card:nth-child(4) { animation-delay: 0.4s; }
    
    .stat-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #ff6b6b, #ff4444, #ff6b6b);
      background-size: 200% 100%;
      animation: shimmer 3s infinite;
    }
    
    @keyframes shimmer {
      0% { background-position: -200% 0; }
      100% { background-position: 200% 0; }
    }
    
    .stat-card:hover {
      transform: translateY(-8px) scale(1.02);
      box-shadow: 0 20px 60px rgba(255, 107, 107, 0.4);
      border-color: rgba(255, 107, 107, 0.4);
    }
    
    .stat-card .number {
      font-size: 3.5rem;
      font-weight: 800;
      background: linear-gradient(135deg, #ff6b6b, #ff4444);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 0.5rem;
      line-height: 1;
      font-variant-numeric: tabular-nums;
      min-height: 4rem;
      display: flex;
      align-items: center;
    }
    
    .stat-card .number.loading {
      background: linear-gradient(90deg, rgba(255, 107, 107, 0.1) 25%, rgba(255, 107, 107, 0.2) 50%, rgba(255, 107, 107, 0.1) 75%);
      background-size: 200% 100%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: shimmer 1.5s infinite;
    }
    
    .stat-card .number.skeleton {
      background: linear-gradient(90deg, rgba(255, 107, 107, 0.1) 0%, rgba(255, 107, 107, 0.2) 50%, rgba(255, 107, 107, 0.1) 100%);
      background-size: 200% 100%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: shimmer 1.5s infinite;
    }
    
    @keyframes shimmer {
      0% {
        background-position: -200% 0;
      }
      100% {
        background-position: 200% 0;
      }
    }
    
    .stat-card .label {
      font-size: 1.05rem;
      color: #b4bac3;
      margin-top: 0.5rem;
      font-weight: 500;
      letter-spacing: 0.02em;
    }

    /* Professional Chart Containers */
    .chart-section {
      margin: 5rem auto;
      max-width: 1200px;
      padding: 0 2rem;
    }
    
    .chart-container {
      background: linear-gradient(135deg, rgba(11, 13, 22, 0.95) 0%, rgba(20, 22, 35, 0.95) 100%);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: 24px;
      padding: 2.5rem;
      margin-bottom: 3rem;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
      transition: all 0.4s ease;
      opacity: 0;
      animation: fadeInUp 0.8s ease-out forwards;
    }
    
    .chart-container:nth-child(1) { animation-delay: 0.1s; }
    .chart-container:nth-child(2) { animation-delay: 0.2s; }
    .chart-container:nth-child(3) { animation-delay: 0.3s; }
    
    .chart-container:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 40px rgba(255, 107, 107, 0.2);
      border-color: rgba(255, 107, 107, 0.3);
    }
    
    .chart-container h3 {
      font-size: 1.6rem;
      color: #ff6b6b;
      margin-bottom: 2rem;
      margin-top: 0;
      font-weight: 700;
      letter-spacing: -0.01em;
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }
    
    .chart-container h3::before {
      content: '';
      width: 4px;
      height: 24px;
      background: linear-gradient(180deg, #ff6b6b, #ff4444);
      border-radius: 2px;
    }
    
    .chart-wrapper {
      position: relative;
      height: 450px;
      margin-top: 1rem;
    }
    
    .chart-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
      gap: 2.5rem;
    }
    
    @media (max-width: 768px) {
      header.hero {
        padding: 4rem 1rem 3rem;
      }
      
      header.hero h1 {
        font-size: clamp(1.8rem, 6vw, 2.5rem);
        line-height: 1.2;
        margin-bottom: 1rem;
      }
      
      header.hero .subtitle {
        font-size: 1rem;
        line-height: 1.5;
      }
      
      header.hero .meta {
        flex-direction: column;
        gap: 0.5rem;
        font-size: 0.85rem;
      }
      
      .export-buttons {
        position: relative !important;
        top: auto !important;
        right: auto !important;
        margin-top: 1rem;
        justify-content: center;
      }
      
      .export-btn {
        font-size: 0.8rem !important;
        padding: 0.4rem 0.8rem !important;
      }
      
      .stats-grid {
        grid-template-columns: 1fr;
        gap: 1.5rem;
        padding: 0 1rem;
      }
      
      .stat-card {
        padding: 1.5rem;
      }
      
      .stat-card .number {
        font-size: 2.5rem;
      }
      
      .stat-card .label {
        font-size: 0.9rem;
      }
      
      .chart-grid {
        grid-template-columns: 1fr;
      }
      
      .chart-wrapper {
        height: 300px;
      }
      
      .chart-container {
        padding: 1.5rem;
      }
      
      .chart-container h3 {
        font-size: 1.2rem;
      }
      
      .report-content {
        padding: 2rem 1rem 4rem;
      }
      
      .report-section {
        margin-bottom: 3rem;
      }
      
      .report-section h2 {
        font-size: 1.5rem;
        padding-left: 0.5rem;
      }
      
      .report-section h3 {
        font-size: 1.2rem;
      }
      
      .content-with-chart {
        grid-template-columns: 1fr;
        gap: 2rem;
      }
      
      .section-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 1rem;
      }
    }
    
    @media (max-width: 480px) {
      header.hero {
        padding: 3rem 1rem 2rem;
      }
      
      header.hero h1 {
        font-size: 1.6rem;
      }
      
      .stat-card .number {
        font-size: 2rem;
      }
      
      .chart-wrapper {
        height: 250px;
      }
      
      .chart-container {
        padding: 1rem;
      }
    }

    /* Professional Report Content */
    .report-content {
      padding: 4rem 2rem 6rem;
      max-width: 1200px;
      margin: 0 auto;
    }
    
    .report-section {
      margin-bottom: 6rem;
      opacity: 0;
      animation: fadeInUp 0.8s ease-out forwards;
    }
    
    .section-header {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      gap: 2rem;
      margin-bottom: 2rem;
      flex-wrap: wrap;
    }
    
    .section-header h2 {
      font-size: 2.5rem;
      font-weight: 800;
      color: #ff6b6b;
      margin: 0;
      letter-spacing: -0.02em;
    }
    
    .section-content {
      font-size: 1.1rem;
      line-height: 1.8;
      color: #d1d5db;
    }
    
    .section-content p {
      margin-bottom: 1.5rem;
    }
    
    .highlight-box {
      background: linear-gradient(135deg, rgba(255, 107, 107, 0.1) 0%, rgba(255, 68, 68, 0.05) 100%);
      border-left: 4px solid #ff6b6b;
      padding: 1.5rem 2rem;
      border-radius: 12px;
      margin: 2rem 0;
    }
    
    .highlight-box strong {
      color: #ff6b6b;
    }
    
    footer {
      text-align: center;
      padding: 4rem 2rem;
      color: #9aa0a6;
      border-top: 1px solid rgba(255, 255, 255, 0.08);
      margin-top: 6rem;
    }
    
    footer a {
      color: #64b5f6;
      text-decoration: none;
    }
    
    footer a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MZ69VXXL"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
  
  <nav>
    <div class="logo">
      <div class="logo-mark"></div>
      <a href="/">Dark AI</a>
    </div>
    <button class="hamburger" id="hamburger" aria-label="Toggle menu">
      <span></span>
      <span></span>
      <span></span>
    </button>
    <div class="nav-links" id="navLinks">
      <a href="/about">About</a>
      <div class="nav-dropdown" id="reportsDropdown">
        <span class="nav-dropdown-toggle">Reports</span>
        <div class="nav-dropdown-menu">
          <a href="/reports/2025-deepfake-report">2025 Deepfake Report</a>
          <a href="/reports/vendor-intelligence-report">Vendor Intelligence Report</a>
          <a href="/reports/shadowstack-infrastructure-report">ShadowStack Infrastructure Report</a>
        </div>
      </div>
      <a href="/shadowstack">ShadowStack</a>
      <a href="/blackwire">BlackWire</a>
      <a href="/personaforge">PersonaForge</a>
      <a href="/about#contact">Contact</a>
    </div>
  </nav>

    <header class="hero">
      <h1>2025 Synthetic Identity Vendor Intelligence Report</h1>
    <p class="subtitle">Comprehensive analysis of the synthetic identity vendor ecosystem based on intelligence gathered from 129+ vendors across multiple platforms</p>
    <div class="meta">
      <span>Published: December 2025</span>
      <span>Data Source: PersonaForge Intelligence Platform</span>
    </div>
    <div class="export-buttons">
      <button onclick="exportReport('csv')" class="export-btn">ðŸ“¥ Download CSV</button>
      <button onclick="exportReport('json')" class="export-btn">ðŸ“¥ Download JSON</button>
    </div>
  </header>

  <!-- Key Statistics -->
  <div class="stats-grid" id="key-stats">
    <div class="stat-card">
      <div class="number" id="total-vendors">{{ report_data.total_vendors|default(0) if report_data else 0 }}</div>
      <div class="label">Total Vendors Tracked</div>
    </div>
        <div class="stat-card">
          <div class="number" id="vendors-with-domains">{{ report_data.vendors_with_domains|default(0) if report_data else 0 }}</div>
          <div class="label">Vendors with Domains</div>
        </div>
    <div class="stat-card">
      <div class="number" id="total-domains">{{ report_data.total_domains|default(0) if report_data else 0 }}</div>
      <div class="label">Domains Analyzed</div>
    </div>
    <div class="stat-card">
      <div class="number" id="telegram-percentage">{{ (report_data.stats.telegram_percentage|default(0) if report_data and report_data.stats else 0) }}%</div>
      <div class="label">% on Telegram</div>
    </div>
  </div>

  <!-- Report Content -->
  <div class="report-content">
    <!-- Executive Summary -->
    <section class="report-section">
      <div class="section-header">
        <h2>Executive Summary</h2>
      </div>
      <div class="section-content">
        <p>
          This intelligence report analyzes the synthetic identity vendor ecosystem based on monitoring 
          <strong id="summary-total-vendors">129+</strong> active vendors across multiple platforms. Through 
          comprehensive domain enrichment including web scraping, natural language processing, SSL/TLS analysis, 
          and security header evaluation, we reveal operational sophistication levels, security postures, and 
          content strategies that characterize this evolving threat landscape.
        </p>
        <div class="highlight-box" id="key-finding-enhanced">
          <strong>Key Intelligence Finding:</strong> Approximately <strong id="summary-telegram-pct">0</strong>% 
          of vendors in our dataset operate on Telegram, indicating the platform's role as a distribution 
          channel among discovered vendors.<span id="sophistication-section" style="display: none;"> Enhanced enrichment analysis reveals <strong id="sophistication-finding"></strong>, 
          suggesting <strong id="sophistication-implication"></strong>.</span>
        </div>
        <div class="highlight-box" id="security-finding" style="display: none; margin-top: 1rem;">
          <strong>Security Posture Analysis:</strong> <span id="security-finding-text"></span><span id="security-implication-section" style="display: none;"> This indicates 
          <span id="security-implication-text"></span>.</span>
        </div>
        <p>
          This analysis leverages PersonaForge's enhanced intelligence collection platform, which performs deep 
          domain analysis including content extraction, sentiment analysis, security posture evaluation, and 
          infrastructure mapping. The enhanced enrichment data enables sophisticated operational profiling that 
          goes beyond basic infrastructure mapping to reveal vendor sophistication, security practices, and 
          operational patterns. The data represents a comprehensive snapshot of the visible ecosystem as of December 2025.
        </p>
      </div>
    </section>

    <!-- Vendor Landscape -->
    <section class="report-section">
      <div class="section-header">
        <h2>Vendor Landscape Overview</h2>
      </div>
      <div class="section-content">
        <p>
          Intelligence collection has identified a diverse ecosystem of synthetic identity vendors operating 
          across multiple categories and platforms. Enhanced enrichment analysis reveals significant variation 
          in operational sophistication, security postures, and content strategies across the ecosystem.
        </p>
        <div id="sophistication-breakdown" style="display: none; background: rgba(255, 107, 107, 0.05); padding: 1.5rem; border-radius: 12px; margin: 1.5rem 0; border-left: 3px solid #ff6b6b;">
          <h4 style="color: #ff6b6b; margin-top: 0;">Operational Sophistication Analysis</h4>
          <p style="margin-bottom: 1rem;">
            Based on SSL certificate quality, security header implementation, and content analysis, enriched 
            domains can be categorized by operational sophistication:
          </p>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
            <div>
              <div style="font-size: 1.5rem; font-weight: 700; color: #4caf50;" id="high-sophistication">0</div>
              <div style="color: #ccc; font-size: 0.9rem;">High Sophistication</div>
              <div style="color: #9aa0a6; font-size: 0.8rem; margin-top: 0.25rem;" id="high-sophistication-pct">0%</div>
            </div>
            <div>
              <div style="font-size: 1.5rem; font-weight: 700; color: #ff9800;" id="medium-sophistication">0</div>
              <div style="color: #ccc; font-size: 0.9rem;">Medium Sophistication</div>
              <div style="color: #9aa0a6; font-size: 0.8rem; margin-top: 0.25rem;" id="medium-sophistication-pct">0%</div>
            </div>
            <div>
              <div style="font-size: 1.5rem; font-weight: 700; color: #f44336;" id="low-sophistication">0</div>
              <div style="color: #ccc; font-size: 0.9rem;">Low Sophistication</div>
              <div style="color: #9aa0a6; font-size: 0.8rem; margin-top: 0.25rem;" id="low-sophistication-pct">0%</div>
            </div>
          </div>
          <p style="margin-top: 1rem; color: #ccc; font-size: 0.9rem;" id="sophistication-explanation">
            High sophistication indicates professional infrastructure with valid SSL certificates and strong 
            security headers. Low sophistication suggests minimal security measures, potentially indicating 
            rapid deployment or lower concern about detection.
          </p>
        </div>
        <div id="content-strategy-insight" style="display: none; margin-top: 1rem;">
          <p>
            <strong>Content Strategy Analysis:</strong> NLP analysis of vendor websites reveals 
            <span id="content-strategy-finding"></span><span id="content-strategy-implication-section" style="display: none;">, indicating 
            <span id="content-strategy-implication"></span>.</span>
          </p>
        </div>
      </div>
      
      <div class="chart-section">
        <div class="chart-container">
          <h3>Vendors by Category</h3>
          <div class="chart-wrapper">
            <canvas id="categoryChart"></canvas>
          </div>
        </div>
        
        <div class="chart-container">
          <h3>Platform Distribution</h3>
          <div class="chart-wrapper">
            <canvas id="platformChart"></canvas>
          </div>
        </div>
      </div>
    </section>

    <!-- Service Analysis -->
    <section class="report-section">
      <div class="section-header">
        <h2>Service Offerings Analysis</h2>
      </div>
      <div class="section-content">
        <p>
          Intelligence collection reveals a standardized set of service offerings across the ecosystem. 
          The most common services include fake identification documents (IDs, driver's licenses), Social 
          Security Numbers (SSN), and KYC bypass tools. Many vendors offer bundled "identity kits" that 
          combine multiple documents and services.
        </p>
        <p>
          <strong>Service Bundling:</strong> Analysis indicates that vendors frequently offer multiple 
          related services, suggesting operational efficiency and customer demand for comprehensive solutions. 
          The prevalence of "scannable" documents (those that pass electronic verification) indicates 
          vendors are responding to increased verification requirements.
        </p>
      </div>
      
      <div class="chart-section">
        <div class="chart-container">
          <h3>Top Services Offered</h3>
          <div class="chart-wrapper">
            <canvas id="servicesChart"></canvas>
          </div>
        </div>
      </div>
    </section>

    <!-- Regional Patterns -->
    <section class="report-section">
      <div class="section-header">
        <h2>Geographic Targeting Patterns</h2>
      </div>
      <div class="section-content">
        <p>
          Intelligence indicates that while vendors may operate from various locations, they primarily target 
          the United States and Canadian markets. This regional focus reflects both demand patterns and the 
          need for region-specific document templates and verification bypass techniques.
        </p>
        <p>
          <strong>Infrastructure Implications:</strong> The concentration of US/Canada-targeted vendors suggests 
          that document production infrastructure and verification bypass methods are optimized for these 
          markets. This may indicate established supply chains and specialized knowledge in these regions.
        </p>
      </div>
      
      <div class="chart-section">
        <div class="chart-container">
          <h3>Vendors by Target Region</h3>
          <div class="chart-wrapper">
            <canvas id="regionsChart"></canvas>
          </div>
        </div>
      </div>
    </section>

    <!-- Text Analysis -->
    <section class="report-section">
      <div class="section-header">
        <h2>Vendor Marketing & Claims Analysis</h2>
      </div>
      <div class="section-content">
        <p>
          Analysis of vendor summaries and descriptions reveals common marketing strategies, quality claims, 
          and operational patterns. This text analysis provides insights into how vendors position themselves 
          and what features they emphasize to potential customers.
        </p>
        <div class="highlight-box">
          <strong>Key Finding:</strong> <strong id="scannable-mentions">-</strong> vendors emphasize "scannable" 
          documents, indicating this is a key selling point. <strong id="bypass-mentions">-</strong> vendors 
          explicitly mention verification bypass capabilities, reflecting the demand for documents that can 
          pass electronic verification systems.
        </div>
      </div>
      
      <div class="chart-section">
        <div class="chart-container">
          <h3>Marketing Keywords by Category</h3>
          <div class="chart-wrapper">
            <canvas id="keywordsChart"></canvas>
          </div>
        </div>
        
        <div class="chart-container">
          <h3>Service Combinations</h3>
          <div class="chart-wrapper">
            <canvas id="combinationsChart"></canvas>
          </div>
        </div>
      </div>
      
      <div class="section-content" style="margin-top: 2rem;">
        <h3 style="color: #ff6b6b; margin-bottom: 1rem;">Common Marketing Claims</h3>
        <div id="marketing-claims" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
          <!-- Will be populated by JavaScript -->
        </div>
        
        <h3 style="color: #ff6b6b; margin-top: 2rem; margin-bottom: 1rem;">Customer Count Claims</h3>
        <p>
          Analysis of vendor descriptions reveals claims about customer base size. These numbers, while 
          potentially inflated for marketing purposes, indicate the scale vendors claim to operate at.
        </p>
        <div id="customer-claims" style="background: rgba(255, 107, 107, 0.05); padding: 1.5rem; border-radius: 12px; margin-top: 1rem;">
          <!-- Will be populated by JavaScript -->
        </div>
      </div>
    </section>

    <!-- Infrastructure Analysis -->
    <section class="report-section">
      <div class="section-header">
        <h2>Infrastructure Intelligence</h2>
      </div>
      <div class="section-content">
        <p>
          Infrastructure analysis reveals operational patterns that can identify vendor relationships and 
          shared resources. Enhanced enrichment enables correlation between infrastructure choices and security 
          postures, revealing sophisticated operational security practices.
        </p>
        <div id="infrastructure-note" class="highlight-box" style="display: none; background: rgba(100, 181, 246, 0.1); border-left: 3px solid #64b5f6;">
          <strong>ðŸ“Š Infrastructure Data Not Yet Available</strong>
          <p style="margin: 0.75rem 0 0 0; color: #90caf9;">
            PersonaForge domains need to be enriched to populate infrastructure data. Once enriched, this section will show:
          </p>
          <ul style="margin: 0.75rem 0 0 1.5rem; color: #90caf9;">
            <li>Hosting providers used by vendors</li>
            <li>CDN services (Cloudflare, etc.)</li>
            <li>Domain registrars</li>
            <li>Security posture correlation with infrastructure choices</li>
          </ul>
          <p style="margin: 1rem 0 0 0; color: #90caf9;">
            <strong>To enrich domains:</strong> Visit the PersonaForge dashboard or use the API endpoint: 
            <code style="background: rgba(0,0,0,0.3); padding: 0.2rem 0.4rem; border-radius: 4px; font-family: monospace;">POST /personaforge/api/vendors-intel/enrich-domains</code>
          </p>
        </div>
        <div id="infrastructure-insights" class="highlight-box" style="display: none;">
          <strong>Infrastructure Clustering:</strong> Shared infrastructure (hosting, CDN) 
          can indicate vendor networks, shared operators, or common service providers. Enhanced enrichment 
          reveals that <strong id="infrastructure-security-correlation"></strong><span id="infrastructure-security-implication-section" style="display: none;">, suggesting 
          <strong id="infrastructure-security-implication"></strong>.</span>
        </div>
        <div id="infrastructure-patterns" style="display: none; margin-top: 1rem;">
          <p>
            <strong>Operational Security Patterns:</strong> Correlation analysis between infrastructure choices 
            and security postures reveals that vendors using legitimate hosting providers 
            <span id="legitimate-hosting-security"></span><span id="legitimate-hosting-implication-section" style="display: none;"> implement proper security measures. This suggests 
            <span id="legitimate-hosting-implication"></span>.</span>
          </p>
          <p style="margin-top: 1rem;">
            The use of legitimate hosting providers and CDNs (such as Cloudflare) with proper security 
            configurations indicates vendors are blending in with normal web traffic while maintaining 
            operational security. This sophisticated approach suggests confidence in their operational 
            security practices and potential for persistence.
          </p>
        </div>
      </div>
      
      <div class="chart-section">
        <div class="chart-grid">
          <div class="chart-container">
            <h3>Top Hosting Providers</h3>
            <div class="chart-wrapper">
              <canvas id="hostingChart"></canvas>
            </div>
          </div>
          
          <div class="chart-container">
            <h3>CDN Usage</h3>
            <div class="chart-wrapper">
              <canvas id="cdnChart"></canvas>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Enhanced Enrichment Analysis -->
    <section class="report-section" id="enhanced-enrichment-section">
      <div class="section-header">
        <h2>Enhanced Domain Intelligence Analysis</h2>
      </div>
      <div class="section-content">
        <p>
          PersonaForge's enhanced enrichment pipeline performs deep analysis of vendor domains, including 
          web scraping, natural language processing, SSL/TLS certificate analysis, and security header 
          evaluation. This section provides insights into the technical characteristics and operational 
          patterns revealed through this comprehensive analysis.
        </p>
        <div id="no-enhanced-data" style="background: rgba(255, 107, 107, 0.05); border-left: 3px solid #ff6b6b; padding: 1.5rem; border-radius: 8px; margin-bottom: 2rem; display: none;">
          <h3 style="color: #ff6b6b; margin-top: 0;">Enhanced Enrichment Data Not Yet Available</h3>
          <p style="color: #ccc;">
            Enhanced enrichment analysis requires domains to be enriched with the latest pipeline features. 
            Currently, <span id="enhanced-enriched-count">0</span> domains have enhanced enrichment data.
          </p>
          <p style="color: #ccc;">
            <strong>To generate enhanced data:</strong> Re-enrich PersonaForge domains using the enhanced 
            enrichment pipeline. This will populate web scraping, NLP analysis, SSL certificate, and 
            security headers data.
          </p>
        </div>
        <div id="enhanced-insights" style="display: none;">
          <div class="highlight-box">
            <strong>Enhanced Intelligence Value:</strong> Deep domain analysis reveals operational patterns, 
            security postures, and content characteristics that are not visible through basic infrastructure 
            mapping. This data enables more sophisticated vendor profiling and relationship detection.
          </div>
        </div>
      </div>
      
      <!-- Web Scraping Stats -->
      <div class="chart-section" id="web-scraping-section" style="display: none;">
        <h3 style="color: #ff6b6b; margin-bottom: 1.5rem;">Web Scraping & Content Analysis</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
          <div style="background: rgba(255, 107, 107, 0.1); padding: 1.5rem; border-radius: 12px; border: 1px solid rgba(255, 107, 107, 0.2);">
            <div style="font-size: 2rem; font-weight: 700; color: #ff6b6b;" id="scraped-domains">-</div>
            <div style="color: #ccc; margin-top: 0.5rem;">Domains Scraped</div>
          </div>
          <div style="background: rgba(255, 107, 107, 0.1); padding: 1.5rem; border-radius: 12px; border: 1px solid rgba(255, 107, 107, 0.2);">
            <div style="font-size: 2rem; font-weight: 700; color: #ff6b6b;" id="avg-load-time">-</div>
            <div style="color: #ccc; margin-top: 0.5rem;">Avg Load Time (s)</div>
          </div>
          <div style="background: rgba(255, 107, 107, 0.1); padding: 1.5rem; border-radius: 12px; border: 1px solid rgba(255, 107, 107, 0.2);">
            <div style="font-size: 2rem; font-weight: 700; color: #ff6b6b;" id="structured-data-count">-</div>
            <div style="color: #ccc; margin-top: 0.5rem;">Structured Data Found</div>
          </div>
          <div style="background: rgba(255, 107, 107, 0.1); padding: 1.5rem; border-radius: 12px; border: 1px solid rgba(255, 107, 107, 0.2);">
            <div style="font-size: 2rem; font-weight: 700; color: #ff6b6b;" id="pricing-domains">-</div>
            <div style="color: #ccc; margin-top: 0.5rem;">Domains with Pricing</div>
          </div>
        </div>
      </div>

      <!-- NLP Analysis Stats -->
      <div class="chart-section" id="nlp-section" style="display: none;">
        <h3 style="color: #ff6b6b; margin-bottom: 1.5rem;">Natural Language Processing Analysis</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
          <div style="background: rgba(100, 181, 246, 0.1); padding: 1.5rem; border-radius: 12px; border: 1px solid rgba(100, 181, 246, 0.2);">
            <div style="font-size: 2rem; font-weight: 700; color: #64b5f6;" id="nlp-domains">-</div>
            <div style="color: #ccc; margin-top: 0.5rem;">Domains Analyzed</div>
          </div>
          <div style="background: rgba(100, 181, 246, 0.1); padding: 1.5rem; border-radius: 12px; border: 1px solid rgba(100, 181, 246, 0.2);">
            <div style="font-size: 2rem; font-weight: 700; color: #64b5f6;" id="total-keywords">-</div>
            <div style="color: #ccc; margin-top: 0.5rem;">Keywords Extracted</div>
          </div>
          <div style="background: rgba(100, 181, 246, 0.1); padding: 1.5rem; border-radius: 12px; border: 1px solid rgba(100, 181, 246, 0.2);">
            <div style="font-size: 2rem; font-weight: 700; color: #64b5f6;" id="total-entities">-</div>
            <div style="color: #ccc; margin-top: 0.5rem;">Entities Identified</div>
          </div>
        </div>
        <div style="background: rgba(100, 181, 246, 0.05); padding: 1.5rem; border-radius: 12px; margin-top: 1rem;">
          <h4 style="color: #64b5f6; margin-top: 0;">Sentiment Analysis</h4>
          <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin-top: 1rem;">
            <div>
              <div style="font-size: 1.5rem; font-weight: 700; color: #4caf50;" id="positive-sentiment">-</div>
              <div style="color: #ccc;">Positive</div>
            </div>
            <div>
              <div style="font-size: 1.5rem; font-weight: 700; color: #ff9800;" id="neutral-sentiment">-</div>
              <div style="color: #ccc;">Neutral</div>
            </div>
            <div>
              <div style="font-size: 1.5rem; font-weight: 700; color: #f44336;" id="negative-sentiment">-</div>
              <div style="color: #ccc;">Negative</div>
            </div>
          </div>
        </div>
        <div style="background: rgba(255, 107, 107, 0.1); border-left: 3px solid #ff6b6b; padding: 1.5rem; margin-top: 1.5rem; border-radius: 8px;">
          <h4 style="color: #ff6b6b; margin-top: 0; margin-bottom: 0.75rem;">Understanding Sentiment Analysis</h4>
          <p style="color: #ccc; line-height: 1.6; margin: 0;">
            Sentiment analysis measures the emotional tone of language used on vendor websites, not whether vendors 
            are being negative about themselves. <strong style="color: #ff6b6b;">Negative sentiment</strong> in this context typically indicates:
          </p>
          <ul style="color: #ccc; line-height: 1.8; margin-top: 0.75rem; margin-bottom: 0; padding-left: 1.5rem;">
            <li><strong>Problem-focused language:</strong> Vendors often frame their services by emphasizing problems 
            with identity verification systems, financial institutions, or government processes</li>
            <li><strong>Aggressive marketing:</strong> Language that uses urgency, warnings, or fear-based messaging 
            to drive sales</li>
            <li><strong>Complaint patterns:</strong> References to difficulties with traditional systems, barriers, 
            or frustrations that their services claim to solve</li>
            <li><strong>Competitive positioning:</strong> Negative comparisons with alternatives or criticism of 
            existing verification methods</li>
          </ul>
          <p style="color: #9aa0a6; font-size: 0.9rem; margin-top: 0.75rem; margin-bottom: 0; font-style: italic;">
            The high proportion of negative sentiment (41 domains) suggests vendors frequently use problem-focused 
            and urgency-driven language to market their services, which is a common pattern in markets that operate 
            in legal gray areas.
          </p>
        </div>
      </div>

      <!-- Security Headers Analysis -->
      <div class="chart-section" id="security-headers-section" style="display: none;">
        <h3 style="color: #ff6b6b; margin-bottom: 1.5rem;">Security Headers Analysis</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
          <div style="background: rgba(76, 175, 80, 0.1); padding: 1.5rem; border-radius: 12px; border: 1px solid rgba(76, 175, 80, 0.2);">
            <div style="font-size: 2rem; font-weight: 700; color: #4caf50;" id="csp-enabled">-</div>
            <div style="color: #ccc; margin-top: 0.5rem;">CSP Enabled</div>
          </div>
          <div style="background: rgba(76, 175, 80, 0.1); padding: 1.5rem; border-radius: 12px; border: 1px solid rgba(76, 175, 80, 0.2);">
            <div style="font-size: 2rem; font-weight: 700; color: #4caf50;" id="hsts-enabled">-</div>
            <div style="color: #ccc; margin-top: 0.5rem;">HSTS Enabled</div>
          </div>
          <div style="background: rgba(100, 181, 246, 0.1); padding: 1.5rem; border-radius: 12px; border: 1px solid rgba(100, 181, 246, 0.2);">
            <div style="font-size: 2rem; font-weight: 700; color: #64b5f6;" id="avg-security-score">-</div>
            <div style="color: #ccc; margin-top: 0.5rem;">Avg Security Score</div>
          </div>
        </div>
        <div style="background: rgba(255, 107, 107, 0.1); border-left: 3px solid #ff6b6b; padding: 1.5rem; margin-top: 1.5rem; border-radius: 8px;">
          <h4 style="color: #ff6b6b; margin-top: 0; margin-bottom: 0.75rem;">Understanding Security Headers</h4>
          <p style="color: #ccc; line-height: 1.6; margin: 0;">
            Security headers are HTTP response headers that websites can use to protect against common web vulnerabilities 
            and attacks. The presence and proper configuration of these headers indicates a vendor's security posture and 
            operational sophistication.
          </p>
          <ul style="color: #ccc; line-height: 1.8; margin-top: 0.75rem; margin-bottom: 0; padding-left: 1.5rem;">
            <li><strong>CSP (Content Security Policy):</strong> Prevents cross-site scripting (XSS) attacks by controlling 
            which resources (scripts, styles, images) can be loaded. Domains with CSP enabled show awareness of XSS risks 
            and have implemented basic protection measures.</li>
            <li><strong>HSTS (HTTP Strict Transport Security):</strong> Forces browsers to use HTTPS connections, preventing 
            man-in-the-middle attacks and protocol downgrade attacks. HSTS indicates vendors are prioritizing encrypted 
            communications and protecting user data in transit.</li>
            <li><strong>Security Score:</strong> A composite metric evaluating the presence and configuration of multiple 
            security headers (CSP, HSTS, X-Frame-Options, X-Content-Type-Options, etc.). Higher scores indicate more 
            comprehensive security implementations.</li>
          </ul>
          <p style="color: #9aa0a6; font-size: 0.9rem; margin-top: 0.75rem; margin-bottom: 0; font-style: italic;">
            Low security header implementation (average score of 11.4/100) suggests many vendors operate with minimal 
            security measures, potentially prioritizing speed of deployment or lower concern about detection over security 
            best practices. This may indicate rapid deployment cycles or a focus on operational security through other means 
            (such as using privacy services or operating through intermediaries like Cloudflare).
          </p>
        </div>
        <div class="chart-container" id="missing-headers-chart-container" style="display: none;">
          <h4 style="color: #ff6b6b;">Most Common Missing Security Headers</h4>
          <div class="chart-wrapper">
            <canvas id="missingHeadersChart"></canvas>
          </div>
        </div>
      </div>
    </section>

    <!-- Threat Implications -->
    <section class="report-section">
      <div class="section-header">
        <h2>Threat Implications</h2>
      </div>
      <div class="section-content">
        <p>
          The scale and sophistication of the synthetic identity vendor ecosystem presents significant 
          challenges for identity verification systems, financial institutions, and law enforcement. 
          Key implications include:
        </p>
        <ul>
          <li><strong>Verification Bypass:</strong> The prevalence of "scannable" documents and KYC bypass 
          services indicates vendors are actively countering electronic verification systems.</li>
          <li><strong>Platform Proliferation:</strong> Among vendors in our dataset, Telegram appears to be a 
          significant distribution channel, enabling rapid vendor proliferation and customer acquisition with minimal infrastructure overhead.</li>
          <li id="threat-sophistication-item" style="display: none;"><strong>Operational Sophistication:</strong> Enhanced enrichment reveals 
          <span id="threat-sophistication-finding"></span><span id="threat-sophistication-implication-section" style="display: none;">, indicating 
          <span id="threat-sophistication-implication"></span>.</span></li>
          <li id="threat-security-item" style="display: none;"><strong>Security Posture Implications:</strong> Analysis of SSL certificates and security 
          headers shows <span id="threat-security-finding"></span><span id="threat-security-implication-section" style="display: none;">, suggesting 
          <span id="threat-security-implication"></span>.</span></li>
          <li><strong>Infrastructure Resilience:</strong> Shared infrastructure patterns combined with security 
          posture analysis suggest vendor networks that can adapt and reconfigure when individual nodes are 
          disrupted, with varying levels of operational security sophistication.</li>
          <li><strong>Service Standardization:</strong> The consistency of service offerings across vendors 
          suggests established supply chains and knowledge sharing within the ecosystem.</li>
        </ul>
      </div>
    </section>

    <!-- Methodology -->
    <section class="report-section">
      <div class="section-header">
        <h2>Intelligence Collection Methodology</h2>
      </div>
      <div class="section-content">
        <p>
          This report is based on intelligence collected through PersonaForge's automated monitoring and 
          analysis platform. The collection methodology includes:
        </p>
        <ul>
          <li><strong>Vendor Discovery:</strong> Automated scanning of public Telegram channels, forums, 
          and clearnet websites for vendor advertisements and service listings</li>
          <li><strong>Infrastructure Mapping:</strong> WHOIS analysis, DNS enumeration, hosting provider 
          identification, and CDN detection for vendor-associated domains</li>
          <li><strong>Domain Enrichment:</strong> Automated analysis of vendor domains including payment 
          processor detection, CMS identification, and content analysis</li>
          <li><strong>Enhanced Enrichment:</strong> Deep domain analysis including web scraping, natural 
          language processing (NLP), SSL/TLS certificate analysis, security headers evaluation, and 
          content extraction (pricing, contact information, service descriptions)</li>
          <li><strong>Intelligence Correlation:</strong> Linking vendor profiles with infrastructure data 
          to identify relationships and operational patterns</li>
        </ul>
        <p>
          <strong>Data Sources:</strong> All intelligence is collected from publicly accessible sources. 
          No private channels, dark web access, or unauthorized data collection methods are used. The 
          analysis represents the visible ecosystem as monitored through December 2025.
        </p>
        <div class="highlight-box">
          <strong>Intelligence Limitations:</strong> This report reflects only the visible vendor ecosystem. 
          Private Telegram channels, invitation-only forums, and vendors using additional operational security 
          measures may not be captured. Infrastructure analysis is limited to domains that have been identified 
          and successfully enriched. Numbers should be considered minimum estimates of the actual ecosystem size.
        </div>
      </div>
    </section>
  </div>

  <footer>
    <p>Report generated by <a href="/personaforge">PersonaForge</a> | <a href="/">Dark AI</a></p>
    <p style="margin-top: 1rem; font-size: 0.9rem;">For questions or additional analysis, contact: <a href="/about#contact">Contact Us</a></p>
  </footer>

  <script>
    // Professional Chart Configuration
    const professionalChartConfig = {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: {
          labels: {
            color: '#d1d5db',
            font: {
              size: 12,
              family: '-apple-system, BlinkMacSystemFont, "Segoe UI", "Inter", "Helvetica Neue", Arial, sans-serif'
            },
            padding: 15
          },
          position: 'bottom'
        },
        tooltip: {
          backgroundColor: 'rgba(10, 11, 20, 0.95)',
          titleColor: '#ff6b6b',
          bodyColor: '#d1d5db',
          borderColor: 'rgba(255, 107, 107, 0.3)',
          borderWidth: 1,
          padding: 12,
          callbacks: {
            label: function(context) {
              let label = context.dataset.label || '';
              if (label) {
                label += ': ';
              }
              // Handle different chart types: horizontal bar uses parsed.x, vertical bar uses parsed.y
              let value = 0;
              if (context.parsed !== null && context.parsed !== undefined) {
                // For horizontal bar charts (indexAxis: 'y'), value is in parsed.x
                if (typeof context.parsed.x === 'number' && !isNaN(context.parsed.x)) {
                  value = context.parsed.x;
                }
                // For vertical bar charts, value is in parsed.y
                else if (typeof context.parsed.y === 'number' && !isNaN(context.parsed.y)) {
                  value = context.parsed.y;
                }
                // Fallback to raw value
                else if (typeof context.raw === 'number' && !isNaN(context.raw)) {
                  value = context.raw;
                }
              }
              // If still no value, try raw
              if (value === 0 && context.raw !== null && context.raw !== undefined) {
                const rawValue = typeof context.raw === 'number' ? context.raw : parseFloat(context.raw);
                if (!isNaN(rawValue) && isFinite(rawValue)) {
                  value = rawValue;
                }
              }
              const total = context.dataset.data.reduce((a, b) => {
                const num = typeof b === 'number' ? b : parseFloat(b) || 0;
                return a + (typeof num === 'number' && !isNaN(num) && isFinite(num) ? num : 0);
              }, 0);
              const percentage = total > 0 ? ((value / total) * 100).toFixed(1) : '0.0';
              label += value + ' (' + percentage + '%)';
              return label;
            }
          }
        }
      }
    };

    // Load and render data (only if not already rendered server-side)
    async function loadReportData() {
      // Check if data was already rendered server-side
      const totalVendorsEl = document.getElementById('total-vendors');
      const hasServerData = totalVendorsEl && totalVendorsEl.textContent && totalVendorsEl.textContent !== 'â€”' && totalVendorsEl.textContent !== 'Loading...';
      
      if (hasServerData) {
        // Data already loaded server-side, just fetch full data for charts
        console.log('Data already loaded server-side, fetching full dataset for charts...');
      } else {
        // No server-side data, show loading state
        const statElements = ['total-vendors', 'vendors-with-domains', 'total-domains', 'telegram-percentage'];
        statElements.forEach(id => {
          const el = document.getElementById(id);
          if (el) {
            el.textContent = 'â€”';
            el.classList.add('loading', 'skeleton');
          }
        });
      }
      
      try {
        const response = await fetch('/personaforge/api/reports/vendor-intelligence-data');
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        const data = await response.json();
        
        // Update key stats (with fade-in animation)
        const updateStat = (id, value, suffix = '') => {
          const element = document.getElementById(id);
          if (element) {
            const displayValue = value + suffix;
            // Remove loading classes
            element.classList.remove('loading', 'skeleton');
            // Reset styles
            element.style.background = '';
            element.style.webkitBackgroundClip = '';
            element.style.webkitTextFillColor = '';
            element.style.backgroundClip = '';
            // Set the value
            element.textContent = displayValue;
            // Fade in animation
            element.style.transition = 'opacity 0.3s ease-in';
            element.style.opacity = '1';
          }
        };
        
        updateStat('total-vendors', data.total_vendors || 0);
        updateStat('vendors-with-domains', data.vendors_with_domains || 0);
        updateStat('total-domains', data.total_domains || 0);
        updateStat('telegram-percentage', data.stats?.telegram_percentage || 0, '%');
        
        // Update summary
        document.getElementById('summary-total-vendors').textContent = data.total_vendors || 0;
        document.getElementById('summary-telegram-pct').textContent = data.stats.telegram_percentage || 0;
        
        // Category Chart (filter empty)
        const categoryData = Object.entries(data.categories || {})
          .filter(([name, info]) => name && (info.total || 0) > 0)
          .map(([name, info]) => ({
            name: name,
            value: info.total || 0
          }))
          .sort((a, b) => b.value - a.value)
          .slice(0, 10);
        
        new Chart(document.getElementById('categoryChart'), {
          type: 'bar',
          data: {
            labels: categoryData.map(d => d.name),
            datasets: [{
              label: 'Vendors',
              data: categoryData.map(d => d.value),
              backgroundColor: 'rgba(255, 107, 107, 0.6)',
              borderColor: '#ff6b6b',
              borderWidth: 2
            }]
          },
          options: {
            ...professionalChartConfig,
            indexAxis: 'y',
            scales: {
              x: {
                ticks: { color: '#9aa0a6' },
                grid: { color: 'rgba(255, 255, 255, 0.05)' }
              },
              y: {
                ticks: { color: '#9aa0a6' },
                grid: { color: 'rgba(255, 255, 255, 0.05)' }
              }
            }
          }
        });
        
        // Platform Chart (filter empty)
        const platformData = Object.entries(data.platforms || {})
          .filter(([name, info]) => name && (info.total || 0) > 0)
          .map(([name, info]) => ({
            name: name,
            value: info.total || 0
          }));
        
        new Chart(document.getElementById('platformChart'), {
          type: 'doughnut',
          data: {
            labels: platformData.map(d => d.name),
            datasets: [{
              data: platformData.map(d => d.value),
              backgroundColor: [
                'rgba(255, 107, 107, 0.8)',
                'rgba(100, 181, 246, 0.8)',
                'rgba(255, 193, 7, 0.8)',
                'rgba(156, 39, 176, 0.8)'
              ],
              borderColor: [
                '#ff6b6b',
                '#64b5f6',
                '#ffc107',
                '#9c27b0'
              ],
              borderWidth: 2
            }]
          },
          options: professionalChartConfig
        });
        
        // Services Chart (filter empty)
        const servicesData = Object.entries(data.services || {})
          .filter(([name, count]) => name && count > 0)
          .sort((a, b) => b[1] - a[1])
          .slice(0, 15)
          .map(([name, count]) => ({ name, count }));
        
        new Chart(document.getElementById('servicesChart'), {
          type: 'bar',
          data: {
            labels: servicesData.map(d => d.name),
            datasets: [{
              label: 'Vendors Offering Service',
              data: servicesData.map(d => d.count),
              backgroundColor: 'rgba(100, 181, 246, 0.6)',
              borderColor: '#64b5f6',
              borderWidth: 2
            }]
          },
          options: {
            ...professionalChartConfig,
            indexAxis: 'y',
            scales: {
              x: {
                ticks: { color: '#9aa0a6' },
                grid: { color: 'rgba(255, 255, 255, 0.05)' }
              },
              y: {
                ticks: { color: '#9aa0a6' },
                grid: { color: 'rgba(255, 255, 255, 0.05)' }
              }
            }
          }
        });
        
        // Regions Chart (normalize and filter)
        const regionsData = Object.entries(data.regions || {})
          .filter(([name, count]) => name && count > 0)
          .sort((a, b) => b[1] - a[1])
          .slice(0, 10)
          .map(([name, count]) => ({ name, count }));
        
        new Chart(document.getElementById('regionsChart'), {
          type: 'bar',
          data: {
            labels: regionsData.map(d => d.name),
            datasets: [{
              label: 'Vendors',
              data: regionsData.map(d => d.count),
              backgroundColor: 'rgba(255, 193, 7, 0.6)',
              borderColor: '#ffc107',
              borderWidth: 2
            }]
          },
          options: {
            ...professionalChartConfig,
            scales: {
              x: {
                ticks: { color: '#9aa0a6' },
                grid: { color: 'rgba(255, 255, 255, 0.05)' }
              },
              y: {
                ticks: { color: '#9aa0a6' },
                grid: { color: 'rgba(255, 255, 255, 0.05)' }
              }
            }
          }
        });
        
        // Show/hide infrastructure insights based on data availability
        const hostingData = Object.entries(data.infrastructure.hosting_providers || {})
          .filter(([name, count]) => name && count > 0)
          .sort((a, b) => b[1] - a[1])
          .slice(0, 10)
          .map(([name, count]) => ({ name, count }));
        
        const cdnData = Object.entries(data.infrastructure.cdns || {})
          .filter(([name, count]) => name && count > 0)
          .sort((a, b) => b[1] - a[1])
          .slice(0, 8)
          .map(([name, count]) => ({ name, count }));
        
        const hasInfrastructureData = hostingData.length > 0 || cdnData.length > 0;
        
        if (hasInfrastructureData) {
          document.getElementById('infrastructure-note').style.display = 'none';
          document.getElementById('infrastructure-insights').style.display = 'block';
          document.getElementById('infrastructure-patterns').style.display = 'block';
        } else {
          document.getElementById('infrastructure-note').style.display = 'block';
          document.getElementById('infrastructure-insights').style.display = 'none';
          document.getElementById('infrastructure-patterns').style.display = 'none';
        }
        
        if (hostingData.length > 0) {
          new Chart(document.getElementById('hostingChart'), {
          type: 'bar',
          data: {
            labels: hostingData.map(d => d.name),
            datasets: [{
              label: 'Domains',
              data: hostingData.map(d => d.count),
              backgroundColor: 'rgba(156, 39, 176, 0.6)',
              borderColor: '#9c27b0',
              borderWidth: 2
            }]
          },
          options: {
            ...professionalChartConfig,
            indexAxis: 'y',
            scales: {
              x: {
                ticks: { color: '#9aa0a6' },
                grid: { color: 'rgba(255, 255, 255, 0.05)' }
              },
              y: {
                ticks: { color: '#9aa0a6' },
                grid: { color: 'rgba(255, 255, 255, 0.05)' }
              }
            }
          }
          });
        } else {
          document.getElementById('hostingChart').parentElement.innerHTML = 
            '<p style="color: #9aa0a6; text-align: center; padding: 2rem;">No hosting provider data available</p>';
        }
        
        // CDN Chart (only if data exists)
        if (cdnData.length > 0) {
          new Chart(document.getElementById('cdnChart'), {
          type: 'doughnut',
          data: {
            labels: cdnData.map(d => d.name),
            datasets: [{
              data: cdnData.map(d => d.count),
              backgroundColor: [
                'rgba(255, 107, 107, 0.8)',
                'rgba(100, 181, 246, 0.8)',
                'rgba(255, 193, 7, 0.8)',
                'rgba(156, 39, 176, 0.8)',
                'rgba(76, 175, 80, 0.8)'
              ],
              borderColor: [
                '#ff6b6b',
                '#64b5f6',
                '#ffc107',
                '#9c27b0',
                '#4caf50'
              ],
              borderWidth: 2
            }]
          },
          options: professionalChartConfig
          });
        } else {
          document.getElementById('cdnChart').parentElement.innerHTML = 
            '<p style="color: #9aa0a6; text-align: center; padding: 2rem;">No CDN data available</p>';
        }
        
        
        // Enhanced Enrichment Data
        if (data.enhanced_enrichment) {
          const enhanced = data.enhanced_enrichment;
          const hasEnhancedData = enhanced.web_scraping?.domains_with_data > 0 || 
                                  enhanced.nlp_analysis?.domains_with_data > 0 ||
                                  enhanced.security_headers?.domains_with_data > 0;
          
          if (hasEnhancedData) {
            document.getElementById('no-enhanced-data').style.display = 'none';
            document.getElementById('enhanced-insights').style.display = 'block';
            
            // Web Scraping Stats
            if (enhanced.web_scraping?.domains_with_data > 0) {
              document.getElementById('web-scraping-section').style.display = 'block';
              document.getElementById('scraped-domains').textContent = enhanced.web_scraping.domains_with_data;
              document.getElementById('avg-load-time').textContent = enhanced.web_scraping.avg_load_time > 0 
                ? enhanced.web_scraping.avg_load_time + 's' : 'N/A';
              document.getElementById('structured-data-count').textContent = enhanced.web_scraping.structured_data_found;
              document.getElementById('pricing-domains').textContent = enhanced.extracted_content?.domains_with_pricing || 0;
            }
            
            // NLP Analysis Stats
            if (enhanced.nlp_analysis?.domains_with_data > 0) {
              document.getElementById('nlp-section').style.display = 'block';
              document.getElementById('nlp-domains').textContent = enhanced.nlp_analysis.domains_with_data;
              document.getElementById('total-keywords').textContent = enhanced.nlp_analysis.total_keywords;
              document.getElementById('total-entities').textContent = enhanced.nlp_analysis.total_entities;
              document.getElementById('positive-sentiment').textContent = enhanced.nlp_analysis.sentiment_analysis?.positive || 0;
              document.getElementById('neutral-sentiment').textContent = enhanced.nlp_analysis.sentiment_analysis?.neutral || 0;
              document.getElementById('negative-sentiment').textContent = enhanced.nlp_analysis.sentiment_analysis?.negative || 0;
            }
            
            
            // Security Headers Stats
            if (enhanced.security_headers?.domains_with_data > 0) {
              document.getElementById('security-headers-section').style.display = 'block';
              document.getElementById('csp-enabled').textContent = enhanced.security_headers.csp_enabled;
              document.getElementById('hsts-enabled').textContent = enhanced.security_headers.hsts_enabled;
              document.getElementById('avg-security-score').textContent = enhanced.security_headers.avg_security_score > 0
                ? enhanced.security_headers.avg_security_score + '/100' : 'N/A';
              
              // Missing Headers Chart
              const missingHeaders = enhanced.security_headers.common_missing_headers || {};
              if (Object.keys(missingHeaders).length > 0) {
                document.getElementById('missing-headers-chart-container').style.display = 'block';
                const missingHeadersData = Object.entries(missingHeaders)
                  .sort((a, b) => b[1] - a[1])
                  .slice(0, 10);
                
                new Chart(document.getElementById('missingHeadersChart'), {
                  type: 'bar',
                  data: {
                    labels: missingHeadersData.map(d => d[0]),
                    datasets: [{
                      label: 'Domains Missing Header',
                      data: missingHeadersData.map(d => d[1]),
                      backgroundColor: 'rgba(244, 67, 54, 0.6)',
                      borderColor: '#f44336',
                      borderWidth: 2
                    }]
                  },
                  options: {
                    ...professionalChartConfig,
                    indexAxis: 'y',
                    scales: {
                      x: {
                        ticks: { color: '#9aa0a6' },
                        grid: { color: 'rgba(255, 255, 255, 0.05)' }
                      },
                      y: {
                        ticks: { color: '#9aa0a6' },
                        grid: { color: 'rgba(255, 255, 255, 0.05)' }
                      }
                    }
                  }
                });
              }
            }
          } else {
            document.getElementById('no-enhanced-data').style.display = 'block';
            document.getElementById('enhanced-insights').style.display = 'none';
            document.getElementById('enhanced-enriched-count').textContent = 0;
          }
        } else {
          document.getElementById('no-enhanced-data').style.display = 'block';
          document.getElementById('enhanced-insights').style.display = 'none';
        }
        
        // Text Analysis Charts
        if (data.text_analysis) {
          const textData = data.text_analysis;
          
          // Update key findings
          const scannableCount = textData.keywords?.quality_claims?.scannable || 0;
          const bypassCount = textData.keywords?.verification_bypass?.bypass || 0;
          document.getElementById('scannable-mentions').textContent = scannableCount;
          document.getElementById('bypass-mentions').textContent = bypassCount;
          
          // Keywords Chart - combine duplicates
          const keywordMap = new Map();
          for (const [category, keywords] of Object.entries(textData.keywords || {})) {
            for (const [keyword, count] of Object.entries(keywords)) {
              const keywordLower = keyword.toLowerCase();
              if (keywordMap.has(keywordLower)) {
                // Combine counts for duplicate keywords
                keywordMap.set(keywordLower, keywordMap.get(keywordLower) + count);
              } else {
                keywordMap.set(keywordLower, count);
              }
            }
          }
          // Convert to array and sort
          const keywordData = Array.from(keywordMap.entries())
            .map(([keyword, count]) => ({ keyword, count }))
            .sort((a, b) => b.count - a.count);
          const topKeywords = keywordData.slice(0, 15);
          
          new Chart(document.getElementById('keywordsChart'), {
            type: 'bar',
            data: {
              labels: topKeywords.map(d => d.keyword),
              datasets: [{
                label: 'Mentions',
                data: topKeywords.map(d => d.count),
                backgroundColor: 'rgba(100, 181, 246, 0.6)',
                borderColor: '#64b5f6',
                borderWidth: 2
              }]
            },
            options: {
              ...professionalChartConfig,
              indexAxis: 'y',
              scales: {
                x: {
                  ticks: { color: '#9aa0a6' },
                  grid: { color: 'rgba(255, 255, 255, 0.05)' }
                },
                y: {
                  ticks: { color: '#9aa0a6' },
                  grid: { color: 'rgba(255, 255, 255, 0.05)' }
                }
              }
            }
          });
          
          // Service Combinations Chart
          const comboData = Object.entries(textData.service_combinations || {})
            .filter(([combo, count]) => count > 1)
            .sort((a, b) => b[1] - a[1])
            .slice(0, 10)
            .map(([combo, count]) => ({
              label: combo, // Already formatted as "Service1 + Service2"
              count: count
            }));
          
          if (comboData.length > 0) {
            new Chart(document.getElementById('combinationsChart'), {
              type: 'bar',
              data: {
                labels: comboData.map(d => d.label),
                datasets: [{
                  label: 'Vendors',
                  data: comboData.map(d => d.count),
                  backgroundColor: 'rgba(255, 193, 7, 0.6)',
                  borderColor: '#ffc107',
                  borderWidth: 2
                }]
              },
              options: {
                ...professionalChartConfig,
                indexAxis: 'y',
                scales: {
                  x: {
                    ticks: { color: '#9aa0a6' },
                    grid: { color: 'rgba(255, 255, 255, 0.05)' }
                  },
                  y: {
                    ticks: { color: '#9aa0a6' },
                    grid: { color: 'rgba(255, 255, 255, 0.05)' }
                  }
                }
              }
            });
          }
          
          // Marketing Claims
          const claimsContainer = document.getElementById('marketing-claims');
          const claims = [];
          for (const [category, keywords] of Object.entries(textData.keywords || {})) {
            for (const [keyword, count] of Object.entries(keywords)) {
              if (count > 2) {
                claims.push({ category, keyword, count });
              }
            }
          }
          claims.sort((a, b) => b.count - a.count);
          
          claimsContainer.innerHTML = claims.slice(0, 12).map(claim => `
            <div style="background: rgba(255, 255, 255, 0.03); padding: 1rem; border-radius: 8px; border-left: 3px solid #ff6b6b;">
              <strong style="color: #ff6b6b;">${claim.keyword}</strong>
              <div style="color: #9aa0a6; font-size: 0.9rem; margin-top: 0.5rem;">
                ${claim.count} vendor${claim.count !== 1 ? 's' : ''} mention this
              </div>
              <div style="color: #666; font-size: 0.8rem; margin-top: 0.25rem; text-transform: capitalize;">
                ${claim.category.replace('_', ' ')}
              </div>
            </div>
          `).join('');
          
          // Customer Claims
          const customerContainer = document.getElementById('customer-claims');
          if (textData.customer_count_claims && textData.customer_count_claims.total_mentions > 0) {
            const claims = textData.customer_count_claims;
            customerContainer.innerHTML = `
              <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1.5rem; margin-top: 1rem;">
                <div>
                  <div style="font-size: 2rem; font-weight: 800; color: #ff6b6b;">${claims.total_mentions}</div>
                  <div style="color: #9aa0a6; font-size: 0.9rem;">Vendors Claim Customer Counts</div>
                </div>
                <div>
                  <div style="font-size: 2rem; font-weight: 800; color: #64b5f6;">${Math.round(claims.average).toLocaleString()}</div>
                  <div style="color: #9aa0a6; font-size: 0.9rem;">Average Claimed</div>
                </div>
                <div>
                  <div style="font-size: 2rem; font-weight: 800; color: #ffc107;">${claims.max.toLocaleString()}</div>
                  <div style="color: #9aa0a6; font-size: 0.9rem;">Highest Claim</div>
                </div>
              </div>
              ${Object.keys(claims.common_values || {}).length > 0 ? `
                <div style="margin-top: 1.5rem;">
                  <strong style="color: #ff6b6b;">Most Common Claims:</strong>
                  <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-top: 0.5rem;">
                    ${Object.entries(claims.common_values).slice(0, 8).map(([count, vendors]) => `
                      <span style="background: rgba(255, 107, 107, 0.1); padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.9rem;">
                        ${count.toLocaleString()} customers (${vendors} vendor${vendors !== 1 ? 's' : ''})
                      </span>
                    `).join('')}
                  </div>
                </div>
              ` : ''}
            `;
          } else {
            customerContainer.innerHTML = '<p style="color: #9aa0a6;">No customer count claims found in vendor descriptions.</p>';
          }
        }
        
        // Populate enhanced insights throughout the report
        if (data.sophistication_analysis) {
          const soph = data.sophistication_analysis;
          
          // Executive Summary - Key Finding
          const sophisticationSection = document.getElementById('sophistication-section');
          if (soph.high_sophistication_pct && soph.high_sophistication_pct > 0) {
            sophisticationSection.style.display = 'inline';
            document.getElementById('sophistication-finding').textContent = 
              `${soph.high_sophistication_pct}% of enriched domains show high operational sophistication`;
            document.getElementById('sophistication-implication').textContent = 
              'vendors are investing in professional infrastructure, suggesting established operations';
          } else if (soph.medium_sophistication_pct && soph.medium_sophistication_pct > 0) {
            sophisticationSection.style.display = 'inline';
            document.getElementById('sophistication-finding').textContent = 
              `${soph.medium_sophistication_pct}% of enriched domains show medium operational sophistication`;
            document.getElementById('sophistication-implication').textContent = 
              'vendors demonstrate mixed infrastructure quality, indicating varied operational maturity';
          } else if (soph.low_sophistication_pct && soph.low_sophistication_pct > 0) {
            sophisticationSection.style.display = 'inline';
            document.getElementById('sophistication-finding').textContent = 
              `${soph.low_sophistication_pct}% of enriched domains show low operational sophistication`;
            document.getElementById('sophistication-implication').textContent = 
              'many vendors operate with minimal infrastructure, potentially indicating rapid deployment or lower concern about detection';
          } else {
            // Hide section if no sophistication data available
            sophisticationSection.style.display = 'none';
          }
          
          // Security Finding in Executive Summary
          if (data.key_insights && data.key_insights.security_posture) {
            const sec = data.key_insights.security_posture;
            if (sec.finding && sec.finding.trim() && sec.finding !== '-' && sec.implication && sec.implication.trim() && sec.implication !== '-') {
              document.getElementById('security-finding').style.display = 'block';
              document.getElementById('security-finding-text').textContent = sec.finding;
              document.getElementById('security-implication-section').style.display = 'inline';
              document.getElementById('security-implication-text').textContent = sec.implication;
            } else {
              // Hide if no complete data
              document.getElementById('security-finding').style.display = 'none';
            }
          } else {
            // Hide if no security data
            document.getElementById('security-finding').style.display = 'none';
          }
          
          // Vendor Landscape - Sophistication Breakdown
          if (soph.high_sophistication > 0 || soph.medium_sophistication > 0 || soph.low_sophistication > 0) {
            document.getElementById('sophistication-breakdown').style.display = 'block';
            document.getElementById('high-sophistication').textContent = soph.high_sophistication;
            document.getElementById('high-sophistication-pct').textContent = `${soph.high_sophistication_pct || 0}%`;
            document.getElementById('medium-sophistication').textContent = soph.medium_sophistication;
            document.getElementById('medium-sophistication-pct').textContent = `${soph.medium_sophistication_pct || 0}%`;
            document.getElementById('low-sophistication').textContent = soph.low_sophistication;
            document.getElementById('low-sophistication-pct').textContent = `${soph.low_sophistication_pct || 0}%`;
          }
          
          // Content Strategy Insight
          if (data.key_insights && data.key_insights.content_strategy) {
            const content = data.key_insights.content_strategy;
            if (content.finding && content.finding.trim() && content.finding !== '-') {
              document.getElementById('content-strategy-insight').style.display = 'block';
              document.getElementById('content-strategy-finding').textContent = content.finding;
              if (content.implication && content.implication.trim() && content.implication !== '-') {
                document.getElementById('content-strategy-implication-section').style.display = 'inline';
                document.getElementById('content-strategy-implication').textContent = content.implication;
              } else {
                document.getElementById('content-strategy-implication-section').style.display = 'none';
              }
            } else {
              document.getElementById('content-strategy-insight').style.display = 'none';
            }
          } else {
            document.getElementById('content-strategy-insight').style.display = 'none';
          }
          
          // Clearnet Sophistication Section
          const vendorsWithDomains = data.vendors_with_domains || 0;
          if (vendorsWithDomains > 0 && soph.high_sophistication_pct > 0) {
            const clearnetSection = document.getElementById('clearnet-sophistication-section');
            if (clearnetSection) {
              clearnetSection.style.display = 'inline';
              const sophisticationLevel = soph.high_sophistication_pct >= 50 ? 'high' : 
                                         soph.medium_sophistication_pct >= 50 ? 'medium' : 'low';
              document.getElementById('clearnet-sophistication').textContent = sophisticationLevel;
              if (soph.high_sophistication_pct >= 50) {
                document.getElementById('clearnet-implication').textContent = 
                  'established operations with professional infrastructure and potential for persistence';
              } else if (soph.medium_sophistication_pct >= 50) {
                document.getElementById('clearnet-implication').textContent = 
                  'varied operational maturity with mixed infrastructure quality';
              } else {
                document.getElementById('clearnet-implication').textContent = 
                  'rapid deployment or lower concern about detection';
              }
            }
          } else {
            const clearnetSection = document.getElementById('clearnet-sophistication-section');
            if (clearnetSection) {
              clearnetSection.style.display = 'none';
            }
          }
          
          // Infrastructure Security Correlation
          if (data.key_insights && data.key_insights.infrastructure_security_correlation) {
            const infra = data.key_insights.infrastructure_security_correlation;
            if (infra.finding && infra.finding.trim() && infra.finding !== '-') {
              document.getElementById('infrastructure-security-correlation').textContent = infra.finding;
              if (infra.implication && infra.implication.trim() && infra.implication !== '-') {
                document.getElementById('infrastructure-security-implication').textContent = infra.implication;
              }
            }
          }
          
          // Security Infrastructure Correlation Details
          if (data.security_infrastructure_correlation) {
            const sic = data.security_infrastructure_correlation;
            if (sic.secure_with_legitimate_hosting > 0) {
              document.getElementById('legitimate-hosting-security').textContent = 'frequently';
              document.getElementById('legitimate-hosting-implication').textContent = 
                'blending in with legitimate traffic while maintaining security suggests sophisticated operational security practices';
            }
          }
          
          // Threat Implications
          if (data.key_insights && data.key_insights.operational_sophistication) {
            const threat = data.key_insights.operational_sophistication;
            if (threat.finding && threat.finding.trim() && threat.finding !== '-') {
              document.getElementById('threat-sophistication-item').style.display = 'list-item';
              document.getElementById('threat-sophistication-finding').textContent = threat.finding;
              if (threat.implication && threat.implication.trim() && threat.implication !== '-') {
                document.getElementById('threat-sophistication-implication-section').style.display = 'inline';
                document.getElementById('threat-sophistication-implication').textContent = threat.implication;
              } else {
                document.getElementById('threat-sophistication-implication-section').style.display = 'none';
              }
            } else {
              document.getElementById('threat-sophistication-item').style.display = 'none';
            }
          } else {
            document.getElementById('threat-sophistication-item').style.display = 'none';
          }
          
          if (data.key_insights && data.key_insights.security_posture) {
            const threatSec = data.key_insights.security_posture;
            if (threatSec.finding && threatSec.finding.trim() && threatSec.finding !== '-') {
              document.getElementById('threat-security-item').style.display = 'list-item';
              document.getElementById('threat-security-finding').textContent = threatSec.finding;
              if (threatSec.implication && threatSec.implication.trim() && threatSec.implication !== '-') {
                document.getElementById('threat-security-implication-section').style.display = 'inline';
                document.getElementById('threat-security-implication').textContent = threatSec.implication;
              } else {
                document.getElementById('threat-security-implication-section').style.display = 'none';
              }
            } else {
              document.getElementById('threat-security-item').style.display = 'none';
            }
          } else {
            document.getElementById('threat-security-item').style.display = 'none';
          }
        }
        
      } catch (error) {
        console.error('Error loading report data:', error);
        // Show error state in stats
        const statElements = ['total-vendors', 'vendors-with-domains', 'total-domains', 'telegram-percentage'];
        statElements.forEach(id => {
          const el = document.getElementById(id);
          if (el) {
            el.classList.remove('loading', 'skeleton');
            el.textContent = 'â€”';
            el.style.background = '';
            el.style.webkitBackgroundClip = '';
            el.style.webkitTextFillColor = '';
            el.style.backgroundClip = '';
            el.style.color = 'rgba(255, 107, 107, 0.5)';
            el.style.opacity = '0.7';
          }
        });
      }
    }
    
    // Load data immediately when page loads
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', loadReportData);
    } else {
      // DOM already loaded, call immediately
      loadReportData();
    }
    
    // Export functionality
    function exportReport(format) {
      const url = `/api/reports/vendor-intelligence/export?format=${format}`;
      window.location.href = url;
    }
  </script>
  
  <script>
    // Handle orientation change - reset layout
    let orientationChangeTimeout;
    function handleOrientationChange() {
      const hamburger = document.getElementById('hamburger');
      const navLinks = document.getElementById('navLinks');
      
      // Close mobile menu on orientation change
      if (hamburger && navLinks) {
        hamburger.classList.remove('active');
        navLinks.classList.remove('active');
      }
      
      // Force repaint to fix layout issues
      document.body.style.display = 'none';
      requestAnimationFrame(function() {
        document.body.style.display = '';
        // Recalculate viewport height
        const vh = window.innerHeight * 0.01;
        document.documentElement.style.setProperty('--vh', `${vh}px`);
      });
    }
    
    // Listen for orientation change
    window.addEventListener('orientationchange', function() {
      clearTimeout(orientationChangeTimeout);
      orientationChangeTimeout = setTimeout(handleOrientationChange, 100);
    });
    
    // Also listen for resize (handles some mobile browsers that don't fire orientationchange)
    let resizeTimeout;
    window.addEventListener('resize', function() {
      clearTimeout(resizeTimeout);
      resizeTimeout = setTimeout(function() {
        const currentWidth = window.innerWidth;
        const currentHeight = window.innerHeight;
        if (Math.abs(currentWidth - (window.lastWidth || currentWidth)) > 100 ||
            Math.abs(currentHeight - (window.lastHeight || currentHeight)) > 100) {
          handleOrientationChange();
          window.lastWidth = currentWidth;
          window.lastHeight = currentHeight;
        }
      }, 150);
    });
    
    // Set initial viewport height variable
    const vh = window.innerHeight * 0.01;
    document.documentElement.style.setProperty('--vh', `${vh}px`);
    
    // Hamburger menu toggle
    const hamburger = document.getElementById('hamburger');
    const navLinks = document.getElementById('navLinks');
    
    if (hamburger && navLinks) {
      hamburger.addEventListener('click', function() {
        hamburger.classList.toggle('active');
        navLinks.classList.toggle('active');
      });
      
      // Close menu when clicking outside
      document.addEventListener('click', function(event) {
        if (!hamburger.contains(event.target) && !navLinks.contains(event.target)) {
          hamburger.classList.remove('active');
          navLinks.classList.remove('active');
        }
      });
    }
    
    // Reports dropdown toggle
    const reportsDropdown = document.getElementById('reportsDropdown');
    if (reportsDropdown) {
      const dropdownToggle = reportsDropdown.querySelector('.nav-dropdown-toggle');
      
      dropdownToggle.addEventListener('click', function(e) {
        e.preventDefault();
        reportsDropdown.classList.toggle('active');
      });
      
      // Close dropdown when clicking outside
      document.addEventListener('click', function(event) {
        if (!reportsDropdown.contains(event.target)) {
          reportsDropdown.classList.remove('active');
        }
      });
    }
  </script>
</body>
</html>

